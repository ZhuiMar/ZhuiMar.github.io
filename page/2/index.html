<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><title>zhuimar</title><link type="text/css" rel="stylesheet" href="/css/pure.css?v=0.0.1"><link type="text/css" rel="stylesheet" href="/css/style.css?v=0.0.1"><script type="text/javascript" src="//cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script></head></html><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">zhuimar</h1><a id="logo" href="/.">zhuimar</a></div><div id="nav-menu"><div class="bitcron_nav"><div class="site_nav_wrap"><div class="site_nav"><span class="a_container"><a href="/." class="selected active current">首页</a></span><span class="a_container"><a href="/archives/">归档</a></span><span class="a_container"><a href="/about/">关于</a></span><span class="a_container"><a href="/blog/">博客</a></span><span class="a_container"><a href="/music/">音乐</a></span><span class="a_container"><a href="/video/">视频</a></span><span class="a_container"><a href="/atom.xml">订阅</a></span></div></div></div></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h2 class="post-title"><a href="/2014/10/07/2014/专用图层  - CAGradientLayer.md/">专用图层 - CAGradientLayer</a></h2><div class="post-meta">2014-10-07</div><div class="post-content"><h3 id="CAGradientLayer"><a href="#CAGradientLayer" class="headerlink" title="CAGradientLayer"></a>CAGradientLayer</h3><p>CAGradientLayer是用来生成两种或更多颜色平滑渐变的。用Core Graphics复制一个CAGradientLayer并将内容绘制到一个普通图层的寄宿图也是有可能的，但是CAGradientLayer的真正好处在于绘制使用了硬件加速。</p></div></div><div class="post"><h2 class="post-title"><a href="/2014/09/30/2014/拉伸过滤/">拉伸过滤</a></h2><div class="post-meta">2014-09-30</div><div class="post-content"><p>最后我们再来谈谈<font color="#DC143C">minificationFilter</font>和<font color="#DC143C">magnificationFilter</font>属性。总得来讲，当我们视图显示一个图片的时候，都应该正确地显示这个图片（意即：以正确的比例和正确的1：1像素显示在屏幕上）。原因如下：</p></div></div><div class="post"><h2 class="post-title"><a href="/2014/09/29/2014/寄宿图 - Custom Drawing/">寄宿图 - Custom Drawing</a></h2><div class="post-meta">2014-09-29</div><div class="post-content"><p>给contents赋CGImage的值不是唯一的设置寄宿图的方法。我们也可以直接用Core Graphics直接绘制寄宿图。能够通过继承UIView并实现-drawRect:方法来自定义绘制。</p></div></div><div class="post"><h2 class="post-title"><a href="/2014/09/27/2014/寄宿图 - contents属性/">寄宿图 - contents属性</a></h2><div class="post-meta">2014-09-27</div><div class="post-content"><font color="#DC143C">CALayer</font> 有一个属性叫做contents，这个属性的类型被定义为id，意味着它可以是任何类型的对象。在这种情况下，你可以给contents属性赋任何值，你的app仍然能够编译通过。但是，在实践中，如果你给contents赋的不是CGImage，那么你得到的图层将是空白的。<br>contents这个奇怪的表现是由Mac OS的历史原因造成的。它之所以被定义为id类型，是因为在Mac OS系统上，这个属性对CGImage和NSImage类型的值都起作用。如果你试图在iOS平台上将UIImage的值赋给它，只能得到一个空白的图层。一些初识Core Animation的iOS开发者可能会对这个感到困惑。<br>头疼的不仅仅是我们刚才提到的这个问题。事实上，你真正要赋值的类型应该是CGImageRef，它是一个指向CGImage结构的指针。UIImage有一个CGImage属性，它返回一个”CGImageRef”,如果你想把这个值直接赋值给CALayer的contents，那你将会得到一个编译错误。因为CGImageRef并不是一个真正的Cocoa对象，而是一个Core Foundation类型。<br>尽管Core Foundation类型跟Cocoa对象在运行时貌似很像（被称作toll-free bridging），他们并不是类型兼容的，不过你可以通过bridged关键字转换。如果要给图层的寄宿图赋值，你可以按照以下这个方法：<br>layer.contents = (<strong>bridge id)image.CGImage;<br><br><br>如果你没有使用ARC（自动引用计数），你就不需要</strong>bridge这部分。但是，你干嘛不用ARC？！<br>让我们来继续修改我们在第一章新建的工程，以便能够展示一张图片而不仅仅是一个背景色。我们已经用代码的方式建立一个图层，那我们就不需要额外的图层了。那么我们就直接把layerView的宿主图层的contents属性设置成图片。<br><br>看代码<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIView</span> *layerView;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="keyword">self</span>.view.backgroundColor = [<span class="built_in">UIColor</span> blackColor];</div><div class="line">    [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.layerView];</div><div class="line"></div><div class="line">    <span class="built_in">UIImage</span> *iamge = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"order_date_icon"</span>];</div><div class="line">    <span class="keyword">self</span>.layerView.layer.contents = (__bridge <span class="keyword">id</span>)iamge.CGImage;</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">UIView</span> *)layerView&#123;</div><div class="line">    <span class="keyword">if</span> (_layerView == <span class="literal">nil</span>) &#123;</div><div class="line">        _layerView = [[<span class="built_in">UIView</span> alloc]init];</div><div class="line">        _layerView.frame = <span class="built_in">CGRectMake</span>(<span class="number">20</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>);</div><div class="line">        _layerView.backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> _layerView;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure><br><br>运行代码就会看见layer上面展示了我们需要添加的图片。我们利用CALayer在一个普通的UIView中显示了一张图片。这不是一个UIImageView，它不是我们通常用来展示图片的方法。通过直接操作图层，我们使用了一些新的函数。<br><br>### contentGravity<br>观察图片你可能会发现 我们加载的图片并不刚好是一个方的，为了适应这个视图，它有一点点被拉伸了。在使用UIImageView的时候遇到过同样的问题，解决方法就是把contentMode属性设置成更合适的值，像这样：<br><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">view.contentMode = <span class="built_in">UIViewContentModeScaleAspectFit</span>;</div></pre></td></tr></table></figure><br><br>这个方法基本和我们遇到的情况的解决方法已经接近了（你可以试一下 ），不过UIView大多数视觉相关的属性比如contentMode，对这些属性的操作其实是对对应图层的操作。<br>CALayer与contentMode对应的属性叫做contentsGravity，但是它是一个NSString类型，而不是像对应的UIKit部分，那里面的值是枚举。contentsGravity可选的常量值有以下一些：<br><br><font color="#DC143C">kCAGravityCenter</font><br><font color="#DC143C">kCAGravityTop</font><br><font color="#DC143C">kCAGravityBottom</font><br><font color="#DC143C">kCAGravityLeft</font><br><font color="#DC143C">kCAGravityRight</font><br><font color="#DC143C">kCAGravityTopLeft</font><br><font color="#DC143C">kCAGravityTopRight</font><br><font color="#DC143C">kCAGravityBottomLeft</font><br><font color="#DC143C">kCAGravityBottomRight</font><br><font color="#DC143C">kCAGravityResize</font><br><font color="#DC143C">kCAGravityResizeAspect</font><br><font color="#DC143C">kCAGravityResizeAspectFill</font></div></div><div class="post"><h2 class="post-title"><a href="/2014/09/01/2014/图层与视图/">图层与视图</a></h2><div class="post-meta">2014-09-01</div><div class="post-content"><h3 id="图层的树状结构"><a href="#图层的树状结构" class="headerlink" title="图层的树状结构"></a>图层的树状结构</h3><p>Core Animation其实是一个令人误解的命名。你可能认为它只是用来做动画的，但实际上它是从一个叫做Layer Kit这么一个不怎么和动画有关的名字演变而来，所以做动画这只是Core Animation特性的冰山一角。</p></div></div><div class="post"><h2 class="post-title"><a href="/2014/08/24/2014/GPU VS CPU/">GPU VS CPU</a></h2><div class="post-meta">2014-08-24</div><div class="post-content"><p>关于绘图和动画有两种处理的方式：<font color="#DC143C">CPU</font>(中央处理器）和<font color="#DC143C">GPU</font>图形处理器）。在现代iOS设备中，都有可以运行不同软件的可编程芯片，但是由于历史原因，我们可以说CPU所做的工作都在软件层面，而GPU在硬件层面。<br>总的来说，我们可以用软件（使用CPU）做任何事情，但是对于图像处理，通常用硬件会更快，因为GPU使用图像对高度并行浮点运算做了优化。由于某些原因，我们想尽可能把屏幕渲染的工作交给硬件去处理。问题在于GPU并没有无限制处理性能，而且一旦资源用完的话，性能就会开始下降了（即使CPU并没有完全占用）</p></div></div><div class="post"><h2 class="post-title"><a href="/2014/08/20/2014/iOS中的单例/">iOS中的单例</a></h2><div class="post-meta">2014-08-20</div><div class="post-content"><p>确保某一个类只有一个实例，而且自行实例化并向整个系统提供这个实例。<font color="#dd0000">确保某个类有且只有一个对象的场景</font><br></p></div></div><div class="post"><h2 class="post-title"><a href="/2014/08/10/2014/iOS按钮点击热区的扩大/">iOS按钮点击热区的扩大</a></h2><div class="post-meta">2014-08-10</div><div class="post-content"><p>经常会遇到这种情况，有些app的删除，展开或着其他按钮设计的图标看上去很小，给过来的icon的资源图片也很小，搭建页面时，按照标注尺寸布局，完成之后确发现。按钮太小无法点击响应,体验很差。 有两个办法来解决这个问题。</p></div></div><div class="post"><h2 class="post-title"><a href="/2014/08/04/2014/子View超出父View范围无法响应/">子View超出父View范围无法响应</a></h2><div class="post-meta">2014-08-04</div><div class="post-content"><p>需要在UIView中实现下面的方法，这样UIButton超出的部分就可以点击了。<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</div><div class="line">    <span class="built_in">UIView</span> *result = [<span class="keyword">super</span> hitTest:point withEvent:event];</div><div class="line">    <span class="built_in">CGPoint</span> buttonPoint = [<span class="keyword">self</span>.button convertPoint:point fromView:<span class="keyword">self</span>];</div><div class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.button pointInside:buttonPoint withEvent:event]) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.button;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p></div></div><div class="post"><h2 class="post-title"><a href="/2014/07/23/2014/指定View倒角位置/">指定View倒角位置</a></h2><div class="post-meta">2014-07-23</div><div class="post-content"><p>如果需要将UIView的4个角全部都为圆角，做法相当简单，只需设置其Layer的cornerRadius属性即可（项目需要使用QuartzCore框架）。而若要指定某几个角（小于4）为圆角而别的不变时，这种方法就不好用了。</p></div></div><div class="paginator pager pagination"><div class="paginator_container pagination_container"><a class="extend prev" rel="prev" href="/">上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">下一页</a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" id="search" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"> 分类</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/">前端开发</a><span class="category-list-count">36</span></li></ul></div><div class="widget"><div class="widget-title"> 标签</div><div class="tagcloud"><a href="/tags/iOS/" style="font-size: 12px;">iOS</a></div></div><div class="widget"><div class="widget-title"> 最新文章</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2014/12/08/2014/组透明/">组透明</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/07/2014/专用图层 - CATransformLayer/">专用图层 - CATransformLayer</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/11/29/2014/专用图层 - CATiledLayer/">专用图层 - CATiledLayer</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/11/23/2014/专用图层 - CATextLayer/">专用图层 - CATextLayer</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/11/21/2014/专用图层 - CAShapeLayer/">专用图层 - CAShapeLayer</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/11/05/2014/专用图层 - CAScrollLayer/">专用图层 - CAScrollLayer</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/10/19/2014/专用图层 - CAEAGLLayer/">专用图层 - CAEAGLLayer</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/10/19/2014/专用图层 - CAEmitterLayer/">专用图层 - CAEmitterLayer</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/10/14/2014/专用图层 - AVPlayerLayer/">专用图层 - AVPlayerLayer</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/10/08/2014/专用图层  - CAShapeLayer/">专用图层 - CAShapeLayer</a></li></ul></div><div class="widget"><div class="widget-title"> 友情链接</div><ul class="links-list"><li class="links-list-item"><a href="http://blog.csdn.net/leixiaohua1020" title="雷霄骅" target="_blank">雷霄骅</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="http://blog.devtang.com/" title="唐巧" target="_blank">唐巧</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="http://casatwy.com" title="田伟宇" target="_blank">田伟宇</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="http://sevennight.cc" title="sevennight" target="_blank">sevennight</a></li></ul><ul class="links-list"><li class="links-list-item"><a href="https://mrlichangming.github.io" title="小明" target="_blank">小明</a></li></ul></div></div></div></div><div id="footer">© <a href="/." rel="nofollow">zhuimar.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> Theme<a target="_blank" href="https://github.com/7ye/maupassant-hexo"> Maupassant.</a></div><a id="back_to_top" href="javascript:void(0)" class="back_to_top"><span>△</span></a><script type="text/javascript" src="/js/totop.js?v=0.0.1"></script><link rel="stylesheet" href="/css/jquery.fancybox.css"><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1"></script><script>function auto_code_fit(){
  if($(".highlight").length != 0){
    var pc_width = $(".post-content").width();
    $(".highlight .code").find("pre").width((pc_width-70)+"px");
  }
}
window.onresize = function(){
  auto_code_fit();
}
auto_code_fit();</script></div></body>