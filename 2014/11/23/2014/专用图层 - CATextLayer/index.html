<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><title>专用图层 - CATextLayer - zhuimar</title><link type="text/css" rel="stylesheet" href="/css/pure.css?v=0.0.1"><link type="text/css" rel="stylesheet" href="/css/style.css?v=0.0.1"><script type="text/javascript" src="//cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script></head></html><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">专用图层 - CATextLayer</h1><a id="logo" href="/.">zhuimar</a></div><div id="nav-menu"><div class="bitcron_nav"><div class="site_nav_wrap"><div class="site_nav"><span class="a_container"><a href="/." class="selected active current">首页</a></span><span class="a_container"><a href="/archives/">归档</a></span><span class="a_container"><a href="/about/">关于</a></span><span class="a_container"><a href="/blog/">博客</a></span><span class="a_container"><a href="/music/">音乐</a></span><span class="a_container"><a href="/video/">视频</a></span><span class="a_container"><a href="/atom.xml">订阅</a></span></div></div></div></div></div><div id="layout" class="pure-g"><div class="pure-u-1"><div class="content_container"><div class="post"><h1 class="post-title">专用图层 - CATextLayer</h1><div class="post-content"><h3 id="CATextLayer"><a href="#CATextLayer" class="headerlink" title="CATextLayer"></a>CATextLayer</h3><p>用户界面是无法从一个单独的图片里面构建的。一个设计良好的图标能够很好地表现一个按钮或控件的意图，不过你迟早都要需要一个不错的老式风格的文本标签。</p>
<p>如果你想在一个图层里面显示文字，完全可以借助图层代理直接将字符串使用Core Graphics写入图层的内容（这就是UILabel的精髓）。如果越过寄宿于图层的视图，直接在图层上操作，那其实相当繁琐。你要为每一个显示文字的图层创建一个能像图层代理一样工作的类，还要逻辑上判断哪个图层需要显示哪个字符串，更别提还要记录不同的字体，颜色等一系列乱七八糟的东西。</p>
<p>万幸的是这些都是不必要的，Core Animation提供了一个CALayer的子类CATextLayer，它以图层的形式包含了UILabel几乎所有的绘制特性，并且额外提供了一些新的特性。</p>
<p>同样，CATextLayer也要比UILabel渲染得快得多。很少有人知道在iOS 6及之前的版本，UILabel其实是通过WebKit来实现绘制的，这样就造成了当有很多文字的时候就会有极大的性能压力。而CATextLayer使用了Core text，并且渲染得非常快。</p>
<p>让我们来尝试用<font color="#DC143C">CATextLayer</font>来显示一些文字<font color="#DC143C">CATextLayer</font> 来实现一个<font color="#DC143C">UILabel</font><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *labelView;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line"></div><div class="line">    <span class="comment">//create a text layer</span></div><div class="line">    <span class="built_in">CATextLayer</span> *textLayer = [<span class="built_in">CATextLayer</span> layer];</div><div class="line">    textLayer.frame = <span class="keyword">self</span>.labelView.bounds;</div><div class="line">    [<span class="keyword">self</span>.labelView.layer addSublayer:textLayer];</div><div class="line"></div><div class="line">    <span class="comment">//set text attributes</span></div><div class="line">    textLayer.foregroundColor = [<span class="built_in">UIColor</span> blackColor].CGColor;</div><div class="line">    textLayer.alignmentMode = kCAAlignmentJustified;</div><div class="line">    textLayer.wrapped = <span class="literal">YES</span>;</div><div class="line"></div><div class="line">    <span class="comment">//choose a font</span></div><div class="line">    <span class="built_in">UIFont</span> *font = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">15</span>];</div><div class="line"></div><div class="line">    <span class="comment">//set layer font</span></div><div class="line">    <span class="built_in">CFStringRef</span> fontName = (__bridge <span class="built_in">CFStringRef</span>)font.fontName;</div><div class="line">    <span class="built_in">CGFontRef</span> fontRef = <span class="built_in">CGFontCreateWithFontName</span>(fontName);</div><div class="line">    textLayer.font = fontRef;</div><div class="line">    textLayer.fontSize = font.pointSize;</div><div class="line">    <span class="built_in">CGFontRelease</span>(fontRef);</div><div class="line"></div><div class="line">    <span class="comment">//choose some text</span></div><div class="line">    <span class="built_in">NSString</span> *text = <span class="string">@"Lorem ipsum dolor sit amet, consectetur adipiscing \ elit. Quisque massa arcu, eleifend vel varius in, facilisis pulvinar \ leo. Nunc quis nunc at mauris pharetra condimentum ut ac neque. Nunc elementum, libero ut porttitor dictum, diam odio congue lacus, vel \ fringilla sapien diam at purus. Etiam suscipit pretium nunc sit amet \ lobortis"</span>;</div><div class="line"></div><div class="line">    <span class="comment">//set layer text</span></div><div class="line">    textLayer.string = text;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>用CATextLayer来显示一个纯文本标签。如果你仔细看这个文本，你会发现一个奇怪的地方：这些文本有一些像素化了。这是因为并没有以Retina的方式渲染，第二章提到了这个contentScale属性，用来决定图层内容应该以怎样的分辨率来渲染。contentsScale并不关心屏幕的拉伸因素而总是默认为1.0。如果我们想以Retina的质量来显示文字，我们就得手动地设置CATextLayer的contentsScale属性，如下：<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">textLayer.contentsScale = [<span class="built_in">UIScreen</span> mainScreen].scale;</div></pre></td></tr></table></figure></p>
<p>设置contentsScale来匹配屏幕<br>CATextLayer的font属性不是一个UIFont类型，而是一个CFTypeRef类型。这样可以根据你的具体需要来决定字体属性应该是用CGFontRef类型还是CTFontRef类型（Core Text字体）。同时字体大小也是用fontSize属性单独设置的，因为CTFontRef和CGFontRef并不像UIFont一样包含点大小。这个例子会告诉你如何将UIFont转换成CGFontRef。</p>
<p>另外，CATextLayer的string属性并不是你想象的NSString类型，而是id类型。这样你既可以用NSString也可以用NSAttributedString来指定文本了（注意，NSAttributedString并不是NSString的子类）。属性化字符串是iOS用来渲染字体风格的机制，它以特定的方式来决定指定范围内的字符串的原始信息，比如字体，颜色，字重，斜体等。</p>
<h3 id="富文本"><a href="#富文本" class="headerlink" title="富文本"></a>富文本</h3><p>iOS 6中，Apple给UILabel和其他UIKit文本视图添加了直接的属性化字符串的支持，应该说这是一个很方便的特性。不过事实上从iOS3.2开始CATextLayer就已经支持属性化字符串了。这样的话，如果你想要支持更低版本的iOS系统，CATextLayer无疑是你向界面中增加富文本的好办法，而且也不用去跟复杂的Core Text打交道，也省了用UIWebView的麻烦。</p>
<p>让我们编辑一下示例使用到NSAttributedString. iOS 6及以上我们可以用新的NSTextAttributeName实例来设置我们的字符串属性，但是练习的目的是为了演示在iOS 5及以下，所以我们用了Core Text，也就是说你需要把Core Text framework添加到你的项目中。否则，编译器是无法识别属性常量的。</p>
<p>运行一下代码 用NSAttributedString实现一个富文本标签<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"DrawingView.h"</span></span></div><div class="line"><span class="meta">#import</span></div><div class="line"><span class="meta">#import</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *labelView;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad&#123;</div><div class="line"></div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line"></div><div class="line">    <span class="comment">//create a text layer</span></div><div class="line">    <span class="built_in">CATextLayer</span> *textLayer = [<span class="built_in">CATextLayer</span> layer];</div><div class="line">    textLayer.frame = <span class="keyword">self</span>.labelView.bounds;</div><div class="line">    textLayer.contentsScale = [<span class="built_in">UIScreen</span> mainScreen].scale;</div><div class="line">    [<span class="keyword">self</span>.labelView.layer addSublayer:textLayer];</div><div class="line"></div><div class="line">    <span class="comment">//set text attributes</span></div><div class="line">    textLayer.alignmentMode = kCAAlignmentJustified;</div><div class="line">    textLayer.wrapped = <span class="literal">YES</span>;</div><div class="line"></div><div class="line">    <span class="comment">//choose a font</span></div><div class="line">    <span class="built_in">UIFont</span> *font = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">15</span>];</div><div class="line"></div><div class="line">    <span class="comment">//choose some text</span></div><div class="line">    <span class="built_in">NSString</span> *text = <span class="string">@"Lorem ipsum dolor sit amet, consectetur adipiscing \ elit. Quisque massa arcu, eleifend vel varius in, facilisis pulvinar \ leo. Nunc quis nunc at mauris pharetra condimentum ut ac neque. Nunc \ elementum, libero ut porttitor dictum, diam odio congue lacus, vel \ fringilla sapien diam at purus. Etiam suscipit pretium nunc sit amet \ lobortis"</span>;</div><div class="line">    ￼</div><div class="line">    <span class="comment">//create attributed string</span></div><div class="line">    <span class="built_in">NSMutableAttributedString</span> *string = <span class="literal">nil</span>;</div><div class="line">    string = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:text];</div><div class="line"></div><div class="line">    <span class="comment">//convert UIFont to a CTFont</span></div><div class="line">    <span class="built_in">CFStringRef</span> fontName = (__bridge <span class="built_in">CFStringRef</span>)font.fontName;</div><div class="line">    <span class="built_in">CGFloat</span> fontSize = font.pointSize;</div><div class="line">    <span class="built_in">CTFontRef</span> fontRef = <span class="built_in">CTFontCreateWithName</span>(fontName, fontSize, <span class="literal">NULL</span>);</div><div class="line"></div><div class="line">    <span class="comment">//set text attributes</span></div><div class="line">    <span class="built_in">NSDictionary</span> *attribs = @&#123;</div><div class="line">        (__bridge <span class="keyword">id</span>)kCTForegroundColorAttributeName:(__bridge <span class="keyword">id</span>)[<span class="built_in">UIColor</span> blackColor].CGColor,</div><div class="line">        (__bridge <span class="keyword">id</span>)kCTFontAttributeName: (__bridge <span class="keyword">id</span>)fontRef</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    [string setAttributes:attribs range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, [text length])];</div><div class="line">    attribs = @&#123;</div><div class="line">        (__bridge <span class="keyword">id</span>)kCTForegroundColorAttributeName: (__bridge <span class="keyword">id</span>)[<span class="built_in">UIColor</span> redColor].CGColor,</div><div class="line">        (__bridge <span class="keyword">id</span>)kCTUnderlineStyleAttributeName: @(kCTUnderlineStyleSingle),</div><div class="line">        (__bridge <span class="keyword">id</span>)kCTFontAttributeName: (__bridge <span class="keyword">id</span>)fontRef</div><div class="line">    &#125;;</div><div class="line">    [string setAttributes:attribs range:<span class="built_in">NSMakeRange</span>(<span class="number">6</span>, <span class="number">5</span>)];</div><div class="line"></div><div class="line">    <span class="comment">//release the CTFont we created earlier</span></div><div class="line">    <span class="built_in">CFRelease</span>(fontRef);</div><div class="line"></div><div class="line">    <span class="comment">//set layer text</span></div><div class="line">    textLayer.string = string;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>以上就是用CATextLayer实现一个富文本标签</p>
<h3 id="行距和字距"><a href="#行距和字距" class="headerlink" title="行距和字距"></a>行距和字距</h3><p>有必要提一下的是，由于绘制的实现机制不同（Core Text和WebKit），用CATextLayer渲染和用UILabel渲染出的文本行距和字距也不是不尽相同的。</p>
<p>二者的差异程度（由使用的字体和字符决定）总的来说挺小，但是如果你想正确的显示普通便签和CATextLayer就一定要记住这一点。</p>
<h3 id="UILabel的替代品"><a href="#UILabel的替代品" class="headerlink" title="UILabel的替代品"></a>UILabel的替代品</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"LayerLabel.h"</span></span></div><div class="line"><span class="meta">#import</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">LayerLabel</span></span></div><div class="line">+ (Class)layerClass&#123;</div><div class="line">    <span class="comment">//this makes our label create a CATextLayer //instead of a regular CALayer for its backing layer</span></div><div class="line">    <span class="keyword">return</span> [<span class="built_in">CATextLayer</span> <span class="keyword">class</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">CATextLayer</span> *)textLayer&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="built_in">CATextLayer</span> *)<span class="keyword">self</span>.layer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setUp&#123;</div><div class="line">    <span class="comment">//set defaults from UILabel settings</span></div><div class="line">    <span class="keyword">self</span>.text = <span class="keyword">self</span>.text;</div><div class="line">    <span class="keyword">self</span>.textColor = <span class="keyword">self</span>.textColor;</div><div class="line">    <span class="keyword">self</span>.font = <span class="keyword">self</span>.font;</div><div class="line"></div><div class="line">    <span class="comment">//we should really derive these from the UILabel settings too</span></div><div class="line">    <span class="comment">//but that's complicated, so for now we'll just hard-code them</span></div><div class="line">    [<span class="keyword">self</span> textLayer].alignmentMode = kCAAlignmentJustified;</div><div class="line">    ￼</div><div class="line">    [<span class="keyword">self</span> textLayer].wrapped = <span class="literal">YES</span>;</div><div class="line">    [<span class="keyword">self</span>.layer display];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">id</span>)initWithFrame:(<span class="built_in">CGRect</span>)frame&#123;</div><div class="line">    <span class="comment">//called when creating label programmatically</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:frame]) &#123;</div><div class="line">        [<span class="keyword">self</span> setUp];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)awakeFromNib&#123;</div><div class="line">    <span class="comment">//called when creating label using Interface Builder</span></div><div class="line">    [<span class="keyword">self</span> setUp];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setText:(<span class="built_in">NSString</span> *)text&#123;</div><div class="line">    <span class="keyword">super</span>.text = text;</div><div class="line">    <span class="comment">//set layer text</span></div><div class="line">    [<span class="keyword">self</span> textLayer].string = text;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setTextColor:(<span class="built_in">UIColor</span> *)textColor&#123;</div><div class="line">    <span class="keyword">super</span>.textColor = textColor;</div><div class="line">    <span class="comment">//set layer text color</span></div><div class="line">    [<span class="keyword">self</span> textLayer].foregroundColor = textColor.CGColor;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setFont:(<span class="built_in">UIFont</span> *)font&#123;</div><div class="line">    <span class="keyword">super</span>.font = font;</div><div class="line">    <span class="comment">//set layer font</span></div><div class="line">    <span class="built_in">CFStringRef</span> fontName = (__bridge <span class="built_in">CFStringRef</span>)font.fontName;</div><div class="line">    <span class="built_in">CGFontRef</span> fontRef = <span class="built_in">CGFontCreateWithFontName</span>(fontName);</div><div class="line">    [<span class="keyword">self</span> textLayer].font = fontRef;</div><div class="line">    [<span class="keyword">self</span> textLayer].fontSize = font.pointSize;</div><div class="line">    ￼</div><div class="line">    <span class="built_in">CGFontRelease</span>(fontRef);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>如果你运行代码，你会发现文本并没有像素化，而我们也没有设置contentsScale属性。把CATextLayer作为宿主图层的另一好处就是视图自动设置了contentsScale属性。</p>
<p>在这个简单的例子中，我们只是实现了UILabel的一部分风格和布局属性，不过稍微再改进一下我们就可以创建一个支持UILabel所有功能甚至更多功能的LayerLabel类（你可以在一些线上的开源项目中找到）。</p>
<p>如果你打算支持iOS 6及以上，基于CATextLayer的标签可能就有有些局限性。但是总得来说，如果想在app里面充分利用CALayer子类，用+layerClass来创建基于不同图层的视图是一个简单可复用的方法。</p>
</div></div><div id="disqus_thread"><script>var disqus_shortname = 'zhuimar';
var disqus_identifier = '2014/11/23/2014/专用图层 - CATextLayer/';
var disqus_title = '专用图层 - CATextLayer';
var disqus_url = 'http://yoursite.com/2014/11/23/2014/专用图层 - CATextLayer/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><!--script(id='dsq-count-scr', src='//#{theme.disqus}.disqus.com/count.js', async)--></div></div></div></div><div id="footer">© <a href="/." rel="nofollow">zhuimar.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> Theme<a target="_blank" href="https://github.com/7ye/maupassant-hexo"> Maupassant.</a></div><a id="back_to_top" href="javascript:void(0)" class="back_to_top"><span>△</span></a><script type="text/javascript" src="/js/totop.js?v=0.0.1"></script><link rel="stylesheet" href="/css/jquery.fancybox.css"><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>function auto_code_fit(){
  if($(".highlight").length != 0){
    var pc_width = $(".post-content").width();
    $(".highlight .code").find("pre").width((pc_width-70)+"px");
  }
}
window.onresize = function(){
  auto_code_fit();
}
auto_code_fit();</script></div></body>